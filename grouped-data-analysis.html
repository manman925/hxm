<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; 分组数据分析 – 数据驱动的可重复性研究</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./grouped-data-analysis-in-action.html" rel="next">
<link href="./git-basic.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-M8996LBB6D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M8996LBB6D');
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./grouped-data-analysis.html">分组数据分析</a></li><li class="breadcrumb-item"><a href="./grouped-data-analysis.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">分组数据分析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">数据驱动的可重复性研究</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">课程简介</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what-is-reproducible-study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">什么是可重复性研究</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">课程项目简介</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">环境搭建</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reproducible-data-analysis-environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">可重复性数据分析环境</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup-a-reproducible-environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">环境配置</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">基础知识</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literate-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">文学化编程</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">命令行程序</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R 语言入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Python 语言入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python-vs-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Python 还是 R？</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Git 与 GitHub 入门</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">分组数据分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grouped-data-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">分组数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grouped-data-analysis-in-action.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">分组数据分析实战</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./score-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">测试成绩分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">转录组数据分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transcriptomics-data-analysis-and-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">转录组学数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transcriptomics-data-analysis-in-action.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">转录组数据分析实战</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">微生物组数据分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./microbiome-data-analysis-and-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">微生物组数据分析及可视化</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">大模型API调用</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how-to-get-api-key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">获取 API KEY</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading-paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">AI 批量读文献</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bailian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">阿里云百炼</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huggingface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Hugging Face</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chatanywhere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">ChatAnyWhere 服务</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deepseek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">DeepSeek R1 模型</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">从零开始神经网络</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neural-network-from-scratch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">手搓神经网络模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-dimensional-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">二维平面拟合</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">机器学习</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning-algorithms-and-implementation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">机器学习算法及实现</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">拉曼光谱识别病原菌</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathogen-identification-with-raman-spectroscopy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">利用拉曼光谱识别病原菌</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bacteria-id-annotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">开源代码释读</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pretrained-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">使用模型进行病原菌检测</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">计算机视觉分析实验图片</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./computer-vision-image-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">计算机视觉分析实验图片</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./segveg-data-preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">数据预处理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./segveg-model-training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">训练 SegVeg 模型</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">开发协作</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collaboration-with-global-developers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">与全世界开发者协作</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-package-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">开发 R 包</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true">
 <span class="menu-text">问题解答</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">FAQ</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Markdown 速查表</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./write-math-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">书写数学公式</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-cheatsheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Quarto 速查表</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2-cheatsheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">ggplot2 速查表</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dplyr-cheatsheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">dplyr 速查表</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#分析体系架构" id="toc-分析体系架构" class="nav-link active" data-scroll-target="#分析体系架构"><span class="header-section-number">11.1</span> 分析体系架构</a>
  <ul class="collapse">
  <li><a href="#适用性差异" id="toc-适用性差异" class="nav-link" data-scroll-target="#适用性差异"><span class="header-section-number">11.1.1</span> 适用性差异</a></li>
  </ul></li>
  <li><a href="#单样本-t-检验" id="toc-单样本-t-检验" class="nav-link" data-scroll-target="#单样本-t-检验"><span class="header-section-number">11.2</span> 单样本 T 检验</a>
  <ul class="collapse">
  <li><a href="#数据特性" id="toc-数据特性" class="nav-link" data-scroll-target="#数据特性"><span class="header-section-number">11.2.1</span> 数据特性</a></li>
  <li><a href="#单样本正态性检验与参数选择" id="toc-单样本正态性检验与参数选择" class="nav-link" data-scroll-target="#单样本正态性检验与参数选择"><span class="header-section-number">11.2.2</span> 单样本正态性检验与参数选择</a></li>
  <li><a href="#应用检验" id="toc-应用检验" class="nav-link" data-scroll-target="#应用检验"><span class="header-section-number">11.2.3</span> 应用检验</a></li>
  <li><a href="#是否有问题" id="toc-是否有问题" class="nav-link" data-scroll-target="#是否有问题"><span class="header-section-number">11.2.4</span> 是否有问题？</a></li>
  </ul></li>
  <li><a href="#单样本-wilcoxon-符号检验" id="toc-单样本-wilcoxon-符号检验" class="nav-link" data-scroll-target="#单样本-wilcoxon-符号检验"><span class="header-section-number">11.3</span> 单样本 Wilcoxon 符号检验</a>
  <ul class="collapse">
  <li><a href="#代码示例" id="toc-代码示例" class="nav-link" data-scroll-target="#代码示例"><span class="header-section-number">11.3.1</span> 代码示例</a></li>
  <li><a href="#结果解读" id="toc-结果解读" class="nav-link" data-scroll-target="#结果解读"><span class="header-section-number">11.3.2</span> 结果解读</a></li>
  <li><a href="#可视化" id="toc-可视化" class="nav-link" data-scroll-target="#可视化"><span class="header-section-number">11.3.3</span> 可视化</a></li>
  </ul></li>
  <li><a href="#独立样本-t-检验" id="toc-独立样本-t-检验" class="nav-link" data-scroll-target="#独立样本-t-检验"><span class="header-section-number">11.4</span> 独立样本 T 检验</a></li>
  <li><a href="#wilcoxon-秩和检验" id="toc-wilcoxon-秩和检验" class="nav-link" data-scroll-target="#wilcoxon-秩和检验"><span class="header-section-number">11.5</span> Wilcoxon 秩和检验</a></li>
  <li><a href="#配对-t-检验" id="toc-配对-t-检验" class="nav-link" data-scroll-target="#配对-t-检验"><span class="header-section-number">11.6</span> 配对 t 检验</a>
  <ul class="collapse">
  <li><a href="#数据集简介" id="toc-数据集简介" class="nav-link" data-scroll-target="#数据集简介"><span class="header-section-number">11.6.1</span> 数据集简介</a></li>
  <li><a href="#进行配对-t-检验" id="toc-进行配对-t-检验" class="nav-link" data-scroll-target="#进行配对-t-检验"><span class="header-section-number">11.6.2</span> 进行配对 t 检验</a></li>
  <li><a href="#可视化-1" id="toc-可视化-1" class="nav-link" data-scroll-target="#可视化-1"><span class="header-section-number">11.6.3</span> 可视化</a></li>
  </ul></li>
  <li><a href="#wilcoxon-符号秩检验" id="toc-wilcoxon-符号秩检验" class="nav-link" data-scroll-target="#wilcoxon-符号秩检验"><span class="header-section-number">11.7</span> Wilcoxon 符号秩检验</a>
  <ul class="collapse">
  <li><a href="#进行-wilcoxon-符号秩检验" id="toc-进行-wilcoxon-符号秩检验" class="nav-link" data-scroll-target="#进行-wilcoxon-符号秩检验"><span class="header-section-number">11.7.1</span> <strong>1. 进行 Wilcoxon 符号秩检验</strong></a></li>
  <li><a href="#数据可视化" id="toc-数据可视化" class="nav-link" data-scroll-target="#数据可视化"><span class="header-section-number">11.7.2</span> <strong>2. 数据可视化</strong></a></li>
  <li><a href="#方法选择建议" id="toc-方法选择建议" class="nav-link" data-scroll-target="#方法选择建议"><span class="header-section-number">11.7.3</span> <strong>3. 方法选择建议</strong></a></li>
  <li><a href="#结果比较与解释" id="toc-结果比较与解释" class="nav-link" data-scroll-target="#结果比较与解释"><span class="header-section-number">11.7.4</span> <strong>4. 结果比较与解释</strong></a></li>
  </ul></li>
  <li><a href="#方差分析anova" id="toc-方差分析anova" class="nav-link" data-scroll-target="#方差分析anova"><span class="header-section-number">11.8</span> 方差分析(ANOVA)</a>
  <ul class="collapse">
  <li><a href="#假设检验" id="toc-假设检验" class="nav-link" data-scroll-target="#假设检验"><span class="header-section-number">11.8.1</span> 假设检验</a></li>
  <li><a href="#多重比较" id="toc-多重比较" class="nav-link" data-scroll-target="#多重比较"><span class="header-section-number">11.8.2</span> 多重比较</a></li>
  </ul></li>
  <li><a href="#kruskal-wallis-检验" id="toc-kruskal-wallis-检验" class="nav-link" data-scroll-target="#kruskal-wallis-检验"><span class="header-section-number">11.9</span> Kruskal-Wallis 检验</a>
  <ul class="collapse">
  <li><a href="#事后比较" id="toc-事后比较" class="nav-link" data-scroll-target="#事后比较"><span class="header-section-number">11.9.1</span> 事后比较</a></li>
  <li><a href="#方法选择建议-1" id="toc-方法选择建议-1" class="nav-link" data-scroll-target="#方法选择建议-1"><span class="header-section-number">11.9.2</span> 方法选择建议</a></li>
  </ul></li>
  <li><a href="#pearson相关系数" id="toc-pearson相关系数" class="nav-link" data-scroll-target="#pearson相关系数"><span class="header-section-number">11.10</span> Pearson相关系数</a>
  <ul class="collapse">
  <li><a href="#检验假设条件" id="toc-检验假设条件" class="nav-link" data-scroll-target="#检验假设条件"><span class="header-section-number">11.10.1</span> 检验假设条件</a></li>
  </ul></li>
  <li><a href="#spearman相关系数" id="toc-spearman相关系数" class="nav-link" data-scroll-target="#spearman相关系数"><span class="header-section-number">11.11</span> Spearman相关系数</a>
  <ul class="collapse">
  <li><a href="#与pearson相关系数的比较" id="toc-与pearson相关系数的比较" class="nav-link" data-scroll-target="#与pearson相关系数的比较"><span class="header-section-number">11.11.1</span> 与Pearson相关系数的比较</a></li>
  </ul></li>
  <li><a href="#多变量分析" id="toc-多变量分析" class="nav-link" data-scroll-target="#多变量分析"><span class="header-section-number">11.12</span> 多变量分析</a>
  <ul class="collapse">
  <li><a href="#manova多变量方差分析" id="toc-manova多变量方差分析" class="nav-link" data-scroll-target="#manova多变量方差分析"><span class="header-section-number">11.12.1</span> MANOVA（多变量方差分析）</a></li>
  <li><a href="#rda冗余分析" id="toc-rda冗余分析" class="nav-link" data-scroll-target="#rda冗余分析"><span class="header-section-number">11.12.2</span> RDA（冗余分析）</a></li>
  <li><a href="#cca典型对应分析" id="toc-cca典型对应分析" class="nav-link" data-scroll-target="#cca典型对应分析"><span class="header-section-number">11.12.3</span> CCA（典型对应分析）</a></li>
  <li><a href="#permanova非参数多变量方差分析" id="toc-permanova非参数多变量方差分析" class="nav-link" data-scroll-target="#permanova非参数多变量方差分析"><span class="header-section-number">11.12.4</span> PERMANOVA（非参数多变量方差分析）</a></li>
  <li><a href="#关键区别与生物学解释" id="toc-关键区别与生物学解释" class="nav-link" data-scroll-target="#关键区别与生物学解释"><span class="header-section-number">11.12.5</span> 关键区别与生物学解释</a></li>
  </ul></li>
  <li><a href="#mantel-分析" id="toc-mantel-分析" class="nav-link" data-scroll-target="#mantel-分析"><span class="header-section-number">11.13</span> Mantel 分析</a>
  <ul class="collapse">
  <li><a href="#加载必要的-r-包和数据" id="toc-加载必要的-r-包和数据" class="nav-link" data-scroll-target="#加载必要的-r-包和数据"><span class="header-section-number">11.13.1</span> 加载必要的 R 包和数据</a></li>
  <li><a href="#计算距离矩阵" id="toc-计算距离矩阵" class="nav-link" data-scroll-target="#计算距离矩阵"><span class="header-section-number">11.13.2</span> 计算距离矩阵</a></li>
  <li><a href="#进行-mantel-分析" id="toc-进行-mantel-分析" class="nav-link" data-scroll-target="#进行-mantel-分析"><span class="header-section-number">11.13.3</span> 进行 Mantel 分析</a></li>
  <li><a href="#可视化-mantel-相关性" id="toc-可视化-mantel-相关性" class="nav-link" data-scroll-target="#可视化-mantel-相关性"><span class="header-section-number">11.13.4</span> 可视化 Mantel 相关性</a></li>
  <li><a href="#mantel-分析的生物学意义" id="toc-mantel-分析的生物学意义" class="nav-link" data-scroll-target="#mantel-分析的生物学意义"><span class="header-section-number">11.13.5</span> Mantel 分析的生物学意义</a></li>
  <li><a href="#总结-1" id="toc-总结-1" class="nav-link" data-scroll-target="#总结-1"><span class="header-section-number">11.13.6</span> 总结</a></li>
  </ul></li>
  <li><a href="#详解-mantel-检验" id="toc-详解-mantel-检验" class="nav-link" data-scroll-target="#详解-mantel-检验"><span class="header-section-number">11.14</span> 详解 Mantel 检验</a>
  <ul class="collapse">
  <li><a href="#距离矩阵的构建" id="toc-距离矩阵的构建" class="nav-link" data-scroll-target="#距离矩阵的构建"><span class="header-section-number">11.14.1</span> 距离矩阵的构建</a></li>
  <li><a href="#计算观察相关性" id="toc-计算观察相关性" class="nav-link" data-scroll-target="#计算观察相关性"><span class="header-section-number">11.14.2</span> 计算观察相关性</a></li>
  <li><a href="#置换检验" id="toc-置换检验" class="nav-link" data-scroll-target="#置换检验"><span class="header-section-number">11.14.3</span> 置换检验</a></li>
  <li><a href="#应用场景" id="toc-应用场景" class="nav-link" data-scroll-target="#应用场景"><span class="header-section-number">11.14.4</span> 应用场景</a></li>
  <li><a href="#优缺点分析" id="toc-优缺点分析" class="nav-link" data-scroll-target="#优缺点分析"><span class="header-section-number">11.14.5</span> 优缺点分析</a></li>
  <li><a href="#实践建议" id="toc-实践建议" class="nav-link" data-scroll-target="#实践建议"><span class="header-section-number">11.14.6</span> 实践建议</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/edit/main/grouped-data-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/blob/main/grouped-data-analysis.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./grouped-data-analysis.html">分组数据分析</a></li><li class="breadcrumb-item"><a href="./grouped-data-analysis.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">分组数据分析</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">分组数据分析</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="分析体系架构" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="分析体系架构"><span class="header-section-number">11.1</span> 分析体系架构</h2>
<p>本教程将从数据复杂度递进的角度，系统介绍不同场景下的统计分析方法：</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 29%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>分析层次</th>
<th>使用场景</th>
<th>参数方法</th>
<th>非参数方法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>单组数据</strong></td>
<td>样本与参考值比较</td>
<td>单样本t检验</td>
<td>单样本Wilcoxon符号检验</td>
</tr>
<tr class="even">
<td><strong>两组比较</strong></td>
<td>组间均值比较</td>
<td>独立样本t检验</td>
<td>Wilcoxon秩和检验</td>
</tr>
<tr class="odd">
<td><strong>配对设计</strong></td>
<td>同一对象不同处理比较</td>
<td>配对t检验</td>
<td>Wilcoxon符号秩检验</td>
</tr>
<tr class="even">
<td><strong>多组比较</strong></td>
<td>多个组别比较</td>
<td>方差分析(ANOVA)</td>
<td>Kruskal-Wallis检验</td>
</tr>
<tr class="odd">
<td><strong>相关分析</strong></td>
<td>变量关联性研究</td>
<td>Pearson相关系数</td>
<td>Spearman相关系数</td>
</tr>
<tr class="even">
<td><strong>多变量分析</strong></td>
<td>多个变量间的关系研究</td>
<td>MANOVA, RDA, CCA</td>
<td>Mantel检验, PERMANOVA</td>
</tr>
</tbody>
</table>
<section id="适用性差异" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="适用性差异"><span class="header-section-number">11.1.1</span> 适用性差异</h3>
<p>参数方法和非参数方法的适用性主要区别在于 <strong>数据分布假设</strong>、<strong>样本量要求</strong> 和 <strong>统计效率</strong>。</p>
<section id="数据分布假设" class="level4" data-number="11.1.1.1">
<h4 data-number="11.1.1.1" class="anchored" data-anchor-id="数据分布假设"><span class="header-section-number">11.1.1.1</span> 1. 数据分布假设</h4>
<ul>
<li><strong>参数方法</strong> 假设数据符合某种特定分布（如正态分布）。例如，t 检验和 ANOVA 假设数据是正态分布的，Pearson 相关假设变量是线性相关的。<br>
</li>
<li><strong>非参数方法</strong> <strong>不依赖特定分布假设</strong>，适用于数据分布未知或非正态的情况。例如，Wilcoxon 检验和 Kruskal-Wallis 检验无需正态性假设，Spearman 相关适用于非线性关系。</li>
</ul>
</section>
<section id="样本量要求" class="level4" data-number="11.1.1.2">
<h4 data-number="11.1.1.2" class="anchored" data-anchor-id="样本量要求"><span class="header-section-number">11.1.1.2</span> 2. 样本量要求</h4>
<ul>
<li><strong>参数方法</strong> 在 <strong>小样本（n &lt; 30）</strong> 时，对正态性假设较敏感；但在 <strong>大样本（n &gt; 30）</strong> 时，根据 <strong>中心极限定理</strong>，数据往往趋于正态分布，因此适用范围更广。<br>
</li>
<li><strong>非参数方法</strong> 适用于 <strong>小样本</strong>，因为它基于数据的秩（排名）而非原始值，不受分布影响。但在大样本时，可能 <strong>比参数方法的统计效率低</strong>。</li>
</ul>
</section>
<section id="统计效率" class="level4" data-number="11.1.1.3">
<h4 data-number="11.1.1.3" class="anchored" data-anchor-id="统计效率"><span class="header-section-number">11.1.1.3</span> 3. 统计效率</h4>
<ul>
<li><strong>参数方法</strong> 在满足假设的情况下 <strong>更高效</strong>，因为它利用了数据的全部信息（如均值和方差）。<br>
</li>
<li><strong>非参数方法</strong> 由于仅依赖秩次，信息利用较少，因此在大样本时统计效能（power）通常低于参数方法。</li>
</ul>
</section>
<section id="适用场景" class="level4" data-number="11.1.1.4">
<h4 data-number="11.1.1.4" class="anchored" data-anchor-id="适用场景"><span class="header-section-number">11.1.1.4</span> 4. 适用场景</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 39%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th><strong>分析类型</strong></th>
<th><strong>参数方法适用情况</strong></th>
<th><strong>非参数方法适用情况</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>单组数据</strong></td>
<td>样本量较大，且数据正态分布</td>
<td>小样本，数据偏态或包含离群值</td>
</tr>
<tr class="even">
<td><strong>两组比较</strong></td>
<td>组间数据正态，方差齐性</td>
<td>组间分布偏态或含异常值</td>
</tr>
<tr class="odd">
<td><strong>配对设计</strong></td>
<td>数据正态，测量误差小</td>
<td>配对数据非正态或有明显离群点</td>
</tr>
<tr class="even">
<td><strong>多组比较</strong></td>
<td>组间数据正态，方差相等</td>
<td>组间数据分布不同或存在异方差</td>
</tr>
<tr class="odd">
<td><strong>相关分析</strong></td>
<td>线性关系，数据正态</td>
<td>变量关系可能是非线性，数据偏态</td>
</tr>
<tr class="even">
<td><strong>多变量分析</strong></td>
<td>变量正态、线性关系</td>
<td>变量不正态、非线性关系，数据存在高维结构</td>
</tr>
</tbody>
</table>
</section>
<section id="总结" class="level4" data-number="11.1.1.5">
<h4 data-number="11.1.1.5" class="anchored" data-anchor-id="总结"><span class="header-section-number">11.1.1.5</span> 总结</h4>
<ul>
<li><strong>优先使用参数方法</strong>，如果数据符合分布假设，统计效能更高。<br>
</li>
<li><strong>使用非参数方法</strong>，如果数据不符合正态性、方差齐性假设，或者数据包含异常值。<br>
</li>
<li><strong>当样本量较小时</strong>，非参数方法往往更稳健。<br>
</li>
<li><strong>当关系是非线性的</strong>，如变量间的非线性相关性分析，应使用非参数方法（Spearman）。</li>
</ul>
<p>这样可以根据实际情况选择合适的方法，保证统计分析的合理性。</p>
</section>
</section>
</section>
<section id="单样本-t-检验" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="单样本-t-检验"><span class="header-section-number">11.2</span> 单样本 T 检验</h2>
<p>单样本t检验用于比较一组样本的均值与一个已知或假设的总体均值之间是否存在显著差异。它基于以下假设：</p>
<ol type="1">
<li>样本来自正态分布总体</li>
<li>样本之间相互独立</li>
<li>样本量足够大（通常n&gt;30）或数据近似正态分布</li>
</ol>
<p>原假设H0：样本均值等于总体均值 备择假设H1：样本均值不等于总体均值</p>
<p>我们使用 <code>ToothGrowth</code> 数据集来演示单样本t检验。这个数据集记录了豚鼠在不同维生素C补充条件下牙齿的生长情况。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示中文</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>showtext<span class="sc">::</span><span class="fu">showtext.auto</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例数据集加载</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ToothGrowth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ToothGrowth数据集的加载完成后，我们首先需要了解数据的基本特征。这个数据集包含60个观测值，每个观测值记录了一只豚鼠在特定实验条件下的牙齿生长长度。</p>
<section id="数据特性" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="数据特性"><span class="header-section-number">11.2.1</span> 数据特性</h3>
<p><code>ToothGrowth</code> 数据集记录豚鼠牙齿在不同剂量维生素C（VC）和橙汁（OJ）补充下的生长情况，主要变量包括：</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>变量名</th>
<th>类型</th>
<th>描述</th>
<th>取值范围</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>len</td>
<td>数值型</td>
<td>牙齿长度（单位：毫米）</td>
<td>4.2 - 33.9</td>
</tr>
<tr class="even">
<td>supp</td>
<td>因子型</td>
<td>补充剂类型</td>
<td>VC（抗坏血酸）/OJ（橙汁）</td>
</tr>
<tr class="odd">
<td>dose</td>
<td>数值型</td>
<td>每日剂量（单位：毫克）</td>
<td>0.5 / 1.0 / 2.0</td>
</tr>
</tbody>
</table>
<ol type="1">
<li><strong>分组设计</strong>：包含两种补充类型的3个剂量水平，构成2×3因子设计</li>
<li><strong>平衡性</strong>：每个处理组合包含10只豚鼠，共计60个观测值</li>
<li><strong>研究意义</strong>：验证不同剂量的维生素C补充对牙齿生长的影响</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据概览</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"数据集维度:"</span>, <span class="fu">dim</span>(ToothGrowth), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>数据集维度: 60 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"剂量分组统计:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>剂量分组统计:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(ToothGrowth<span class="sc">$</span>supp, ToothGrowth<span class="sc">$</span>dose))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    
     0.5  1  2
  OJ  10 10 10
  VC  10 10 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制分组分布图</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">fill =</span> supp)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"剂量（毫克/天）"</span>, <span class="at">y =</span> <span class="st">"样本数量"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"实验设计结构"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="单样本正态性检验与参数选择" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="单样本正态性检验与参数选择"><span class="header-section-number">11.2.2</span> 单样本正态性检验与参数选择</h3>
<p>在进行单样本t检验之前，我们需要先检验数据是否满足正态分布假设。这里使用Shapiro-Wilk检验，这是一种广泛使用的正态性检验方法。</p>
<p>检验的假设为： H0：数据服从正态分布 H1：数据不服从正态分布</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 整体数据正态性检验</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>shapiro_total <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 评估参数检验适用性</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(shapiro_total<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">→ 数据符合正态分布（p &gt;0.05），可以采用参数检验方法。</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">→ 数据偏离正态分布（p ≤0.05），建议优先使用非参数方法。</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
→ 数据符合正态分布（p &gt;0.05），可以采用参数检验方法。</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果可视化</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(ToothGrowth, <span class="st">"len"</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q正态性检验图"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"总体验证: W ="</span>, <span class="fu">round</span>(shapiro_total<span class="sc">$</span>statistic,<span class="dv">3</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"p ="</span>, <span class="fu">round</span>(shapiro_total<span class="sc">$</span>p.value,<span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>从正态性检验结果来看：</p>
<ol type="1">
<li>Shapiro-Wilk检验的p值大于0.05，表明我们不能拒绝原假设，即数据可以认为服从正态分布。</li>
<li>Q-Q图显示大多数点都落在对角线附近，进一步支持数据的正态性。</li>
<li>这意味着我们可以继续使用参数检验方法（t检验）来分析数据。</li>
</ol>
</section>
<section id="应用检验" class="level3" data-number="11.2.3">
<h3 data-number="11.2.3" class="anchored" data-anchor-id="应用检验"><span class="header-section-number">11.2.3</span> 应用检验</h3>
<p>在确认数据满足正态分布假设后，我们可以进行单样本t检验。这里我们将样本均值与一个假设的参考值进行比较：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置理论参考值（可根据实际研究设定）</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>reference_value <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 单样本t检验</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>t_one_sample <span class="ot">=</span> <span class="fu">t.test</span>(ToothGrowth<span class="sc">$</span>len, <span class="at">mu =</span> reference_value)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果可视化</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> reference_value, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> reference_value <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"参考值 ="</span>, reference_value),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"牙齿长度"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"单样本均值比较"</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"t("</span>, t_one_sample<span class="sc">$</span>parameter, <span class="st">") ="</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">round</span>(t_one_sample<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"p ="</span>, <span class="fu">round</span>(t_one_sample<span class="sc">$</span>p.value, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>从单样本t检验的结果可以看出：</p>
<ol type="1">
<li>t检验统计量和自由度：t(59) = 0.82，表示检验基于60个样本（自由度=n-1=59）。</li>
<li>p值为0.413，远大于显著性水平0.05，这意味着我们不能拒绝原假设。</li>
<li>可视化结果显示：
<ul>
<li>蓝色小提琴图展示了数据的整体分布</li>
<li>内部的箱线图显示了中位数和四分位数范围</li>
<li>红色虚线表示参考值（18）</li>
</ul></li>
<li>结论：样本的平均牙齿生长长度与参考值18之间没有统计学上的显著差异。</li>
</ol>
</section>
<section id="是否有问题" class="level3" data-number="11.2.4">
<h3 data-number="11.2.4" class="anchored" data-anchor-id="是否有问题"><span class="header-section-number">11.2.4</span> 是否有问题？</h3>
<p>然而，我们需要进一步思考这个分析是否合适。由于数据包含两种不同的补充剂类型（OJ和VC），将所有数据合并进行单样本检验可能会掩盖各组的特征。让我们检验各组的正态性：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 分组正态性检验</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>shapiro_OJ <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"OJ"</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>shapiro_VC <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"VC"</span>])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果显示</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### 正态性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>### 正态性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. 总体检验: W ="</span>, <span class="fu">round</span>(shapiro_total<span class="sc">$</span>statistic,<span class="dv">3</span>),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p ="</span>, <span class="fu">round</span>(shapiro_total<span class="sc">$</span>p.value,<span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. 总体检验: W = 0.967 p = 0.109 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. OJ组检验: W ="</span>, <span class="fu">round</span>(shapiro_OJ<span class="sc">$</span>statistic,<span class="dv">3</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p ="</span>, <span class="fu">round</span>(shapiro_OJ<span class="sc">$</span>p.value,<span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. OJ组检验: W = 0.918 p = 0.024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. VC组检验: W ="</span>, <span class="fu">round</span>(shapiro_VC<span class="sc">$</span>statistic,<span class="dv">3</span>),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p ="</span>, <span class="fu">round</span>(shapiro_VC<span class="sc">$</span>p.value,<span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. VC组检验: W = 0.966 p = 0.428 </code></pre>
</div>
</div>
<p>从分组正态性检验的结果我们可以发现：</p>
<ol type="1">
<li>总体数据的正态性检验结果：W = 0.967，p = 0.109，符合正态分布。</li>
<li>OJ组的正态性检验：W = 0.918，p = 0.024，不符合正态分布。</li>
<li>VC组的正态性检验：W = 0.966，p = 0.428，符合正态分布。</li>
</ol>
<p>这个结果提示我们：</p>
<ol type="1">
<li>虽然各组数据都符合正态分布假设，但将不同处理组的数据合并分析可能并不合适。</li>
<li>更好的分析策略是：
<ul>
<li>分别对OJ组和VC组进行单样本t检验</li>
<li>或者使用双样本t检验比较两组之间的差异</li>
<li>考虑剂量因素的影响，可能需要使用方差分析(ANOVA)</li>
</ul></li>
</ol>
<p>这个案例说明，在进行统计分析时，不仅要考虑统计方法的适用条件，还要充分理解数据的结构和研究问题的本质。</p>
</section>
</section>
<section id="单样本-wilcoxon-符号检验" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="单样本-wilcoxon-符号检验"><span class="header-section-number">11.3</span> 单样本 Wilcoxon 符号检验</h2>
<p>当数据不满足正态分布假设时，我们需要使用非参数方法 - Wilcoxon符号检验。这种方法的优势在于：</p>
<ol type="1">
<li>不要求数据服从正态分布</li>
<li>对异常值不敏感</li>
<li>适用于定序数据</li>
<li>样本量可以较小</li>
</ol>
<p>检验的假设为： H0：总体中位数等于假设值 H1：总体中位数不等于假设值</p>
<section id="代码示例" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="代码示例"><span class="header-section-number">11.3.1</span> 代码示例</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ToothGrowth"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 设定假设检验</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: 牙齿生长的中位数等于 18</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: 牙齿生长的中位数不等于 18</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(ToothGrowth<span class="sc">$</span>len, <span class="at">mu =</span> <span class="dv">18</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  ToothGrowth$len
V = 1030.5, p-value = 0.3972
alternative hypothesis: true location is not equal to 18</code></pre>
</div>
</div>
</section>
<section id="结果解读" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="结果解读"><span class="header-section-number">11.3.2</span> 结果解读</h3>
<ul>
<li><code>V</code> 值是 Wilcoxon 符号检验统计量。<br>
</li>
<li><code>p-value</code> 用于判断显著性，若 p &lt; 0.05，则拒绝原假设，说明牙齿生长的中位数显著不同于 18。<br>
</li>
<li><code>alternative</code> 设置为 <code>"two.sided"</code> 进行双侧检验，也可以改为 <code>"greater"</code> 或 <code>"less"</code> 进行单侧检验。</li>
</ul>
</section>
<section id="可视化" class="level3" data-number="11.3.3">
<h3 data-number="11.3.3" class="anchored" data-anchor-id="可视化"><span class="header-section-number">11.3.3</span> 可视化</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> len)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">18</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"牙齿生长长度分布"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"长度"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"频数"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>这段代码绘制了 <code>len</code> 的直方图，并用红色虚线标出假设的中位数 15。</p>
</section>
</section>
<section id="独立样本-t-检验" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="独立样本-t-检验"><span class="header-section-number">11.4</span> 独立样本 T 检验</h2>
<p>独立样本t检验用于比较两个独立组的均值是否存在显著差异。在进行检验之前，需要满足以下假设：</p>
<ol type="1">
<li>两组样本相互独立</li>
<li>每组样本都来自正态分布总体</li>
<li>两组样本具有相同的总体方差（方差齐性）</li>
</ol>
<p>我们使用ToothGrowth数据集比较两种补充剂（OJ和VC）对牙齿生长的影响。首先进行数据可视化：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ToothGrowth"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> supp, <span class="at">y =</span> len, <span class="at">fill =</span> supp)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Tooth Growth Analysis"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Supplement"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Tooth Length"</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>从箱线图可以观察到： 1. OJ组的中位数略高于VC组 2. 两组的数据分布都相对对称 3. 存在一些离群值 4. 两组的方差看起来相近</p>
<p>在进行t检验之前，我们需要检验数据是否满足假设条件：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正态性检验</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>shapiro_OJ <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"OJ"</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>shapiro_VC <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"VC"</span>])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差齐性检验</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>var_test <span class="ot">=</span> <span class="fu">var.test</span>(len <span class="sc">~</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示检验结果</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Normality Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Normality Test Results:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"OJ group: W ="</span>, <span class="fu">round</span>(shapiro_OJ<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_OJ<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OJ group: W = 0.918 , p = 0.024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"VC group: W ="</span>, <span class="fu">round</span>(shapiro_VC<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_VC<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VC group: W = 0.966 , p = 0.428 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variance Homogeneity Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variance Homogeneity Test Results:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  len by supp
F = 0.6386, num df = 29, denom df = 29, p-value = 0.2331
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.3039488 1.3416857
sample estimates:
ratio of variances 
         0.6385951 </code></pre>
</div>
</div>
<p>从检验结果可以看出：</p>
<ol type="1">
<li>正态性检验：
<ul>
<li>OJ组：p = 0.024 &lt; 0.05，不满足正态分布假设</li>
<li>VC组：p = 0.428 &gt; 0.05，满足正态分布假设</li>
</ul></li>
<li>方差齐性检验：
<ul>
<li>F检验的p值为 0.233 &gt; 0.05，说明两组方差没有显著差异，满足方差齐性假设</li>
</ul></li>
</ol>
<p>虽然OJ组不完全满足正态分布假设，但由于： 1. 样本量相对较大（每组30个样本） 2. t检验对正态性假设的轻微违反具有一定的稳健性 3. 箱线图显示数据分布相对对称</p>
<p>我们仍可以谨慎地使用t检验，同时建议后续使用非参数方法（Wilcoxon秩和检验）进行验证。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行 t 检验</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">=</span> <span class="fu">t.test</span>(len <span class="sc">~</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  len by supp
t = 1.9153, df = 55.309, p-value = 0.06063
alternative hypothesis: true difference in means between group OJ and group VC is not equal to 0
95 percent confidence interval:
 -0.1710156  7.5710156
sample estimates:
mean in group OJ mean in group VC 
        20.66333         16.96333 </code></pre>
</div>
</div>
<p>t检验结果显示： 1. t统计量 = 1.915，自由度 = 55.309 2. p值 = 0.061 &gt; 0.05，未达到显著性水平 3. 95%置信区间为[-0.171, 7.571]，包含0 4. 结论：虽然OJ组的平均牙齿生长长度（20.66）高于VC组（16.96），但这种差异在统计学上并不显著</p>
<p>这个结果提示我们： 1. 两种补充剂对牙齿生长的效果可能没有实质性差异 2. 需要考虑其他因素（如剂量）的影响 3. 建议增加样本量以提高检验的统计效力</p>
</section>
<section id="wilcoxon-秩和检验" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="wilcoxon-秩和检验"><span class="header-section-number">11.5</span> Wilcoxon 秩和检验</h2>
<p>可以使用 <code>ggpubr</code> 进行 <strong>Wilcoxon 秩和检验</strong>（Mann-Whitney U 检验），并在图中显示显著性（p 值）。以下是基于 <code>ToothGrowth</code> 数据集的示例，比较 <code>supp</code>（补充剂类型）对 <code>len</code>（牙齿生长长度）的影响。</p>
<section id="代码示例-1" class="level4" data-number="11.5.0.1">
<h4 data-number="11.5.0.1" class="anchored" data-anchor-id="代码示例-1"><span class="header-section-number">11.5.0.1</span> 代码示例</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制箱线图并添加 Wilcoxon 秩和检验结果</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"supp"</span>, <span class="at">y =</span> <span class="st">"len"</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"supp"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"wilcox.test"</span>, <span class="at">label =</span> <span class="st">"p.format"</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OJ vs. VC 补充剂对牙齿生长的影响（Wilcoxon 检验）"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"补充剂类型"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"牙齿生长长度"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="代码解释" class="level4" data-number="11.5.0.2">
<h4 data-number="11.5.0.2" class="anchored" data-anchor-id="代码解释"><span class="header-section-number">11.5.0.2</span> 代码解释</h4>
<ol type="1">
<li><strong><code>ggboxplot()</code></strong>：绘制分组箱线图，并使用 <code>color</code> 区分类别。<br>
</li>
<li><strong><code>stat_compare_means(method = "wilcox.test", label = "p.format")</code></strong>：
<ul>
<li><code>wilcox.test</code> 进行 <strong>Wilcoxon 秩和检验</strong>（Mann-Whitney U 检验）。<br>
</li>
<li><code>p.format</code> 以格式化方式显示 p 值。<br>
</li>
</ul></li>
<li><strong><code>labs()</code></strong>：设置图表标题和坐标轴标签。</li>
</ol>
<p>运行代码后，图上会显示两种补充剂对牙齿生长的影响，并标注 Wilcoxon 秩和检验的 p 值，以判断组间差异是否显著。</p>
</section>
<section id="方法的选择" class="level4" data-number="11.5.0.3">
<h4 data-number="11.5.0.3" class="anchored" data-anchor-id="方法的选择"><span class="header-section-number">11.5.0.3</span> 方法的选择</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正态性检验</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>shapiro_OJ <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"OJ"</span>])</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>shapiro_VC <span class="ot">=</span> <span class="fu">shapiro.test</span>(ToothGrowth<span class="sc">$</span>len[ToothGrowth<span class="sc">$</span>supp <span class="sc">==</span> <span class="st">"VC"</span>])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差齐性检验</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>var_test <span class="ot">=</span> <span class="fu">var.test</span>(len <span class="sc">~</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 检验结果整合</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>assumptions_met <span class="ot">=</span> shapiro_OJ<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                shapiro_VC<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                var_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法选择建议</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (assumptions_met) {</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">由于数据满足参数假设，t检验更为敏感高效"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">由于违反参数假设，Wilcoxon检验结果更为可靠"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

由于违反参数假设，Wilcoxon检验结果更为可靠</code></pre>
</div>
</div>
</section>
</section>
<section id="配对-t-检验" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="配对-t-检验"><span class="header-section-number">11.6</span> 配对 t 检验</h2>
<p>使用 <code>sleep</code> 数据集进行 <strong>配对 t 检验</strong>，并使用 <code>ggpubr</code> 可视化分析结果。</p>
<section id="数据集简介" class="level3" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="数据集简介"><span class="header-section-number">11.6.1</span> 数据集简介</h3>
<p><code>sleep</code> 数据集包含 10 名受试者在两种不同药物 (<code>group</code> 变量) 下的额外睡眠时间 (<code>extra</code> 变量)。<br>
我们可以检验 <strong>两种药物是否导致的睡眠时间有显著差异</strong>。</p>
</section>
<section id="进行配对-t-检验" class="level3" data-number="11.6.2">
<h3 data-number="11.6.2" class="anchored" data-anchor-id="进行配对-t-检验"><span class="header-section-number">11.6.2</span> 进行配对 t 检验</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sleep"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 将数据按组拆分</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> sleep<span class="sc">$</span>extra[sleep<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>]  <span class="co"># 第一组数据</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> sleep<span class="sc">$</span>extra[sleep<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>]  <span class="co"># 第二组数据</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行配对 t 检验</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">=</span> <span class="fu">t.test</span>(group1, group2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  group1 and group2
t = -4.0621, df = 9, p-value = 0.002833
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.4598858 -0.7001142
sample estimates:
mean difference 
          -1.58 </code></pre>
</div>
</div>
<section id="解释" class="level4" data-number="11.6.2.1">
<h4 data-number="11.6.2.1" class="anchored" data-anchor-id="解释"><span class="header-section-number">11.6.2.1</span> 解释</h4>
<ul>
<li><code>group1</code> 和 <code>group2</code> 是 <strong>同一批受试者</strong> 在 <strong>两种药物下</strong> 的睡眠时间。</li>
<li><code>t.test(group1, group2, paired = TRUE)</code> 进行 <strong>配对 t 检验</strong>，正确使用 <code>paired = TRUE</code>。</li>
</ul>
</section>
</section>
<section id="可视化-1" class="level3" data-number="11.6.3">
<h3 data-number="11.6.3" class="anchored" data-anchor-id="可视化-1"><span class="header-section-number">11.6.3</span> 可视化</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制配对样本数据的箱线图 + 配对连线</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpaired</span>(sleep, <span class="at">x =</span> <span class="st">"group"</span>, <span class="at">y =</span> <span class="st">"extra"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"group"</span>, <span class="at">line.color =</span> <span class="st">"gray"</span>, <span class="at">line.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">label =</span> <span class="st">"p.format"</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"两种药物对睡眠时间的影响（配对 t 检验）"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"药物组"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"额外睡眠时间"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="结果解读-1" class="level4" data-number="11.6.3.1">
<h4 data-number="11.6.3.1" class="anchored" data-anchor-id="结果解读-1"><span class="header-section-number">11.6.3.1</span> 结果解读</h4>
<ul>
<li><code>p-value &lt; 0.05</code> 说明两种药物在 <strong>睡眠时间上的影响显著不同</strong>。</li>
<li><strong>箱线图</strong> 直观显示 <strong>睡眠时间的分布</strong>，灰色连线表示相同受试者在不同药物下的数据。</li>
</ul>
<p>这样即可完成 <strong>配对 t 检验的正确实现和可视化</strong>。</p>
</section>
</section>
</section>
<section id="wilcoxon-符号秩检验" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="wilcoxon-符号秩检验"><span class="header-section-number">11.7</span> Wilcoxon 符号秩检验</h2>
<p>Wilcoxon符号秩检验是配对t检验的非参数替代方法，适用于以下情况：</p>
<ol type="1">
<li>配对数据不满足正态分布假设</li>
<li>样本量较小</li>
<li>存在异常值或极端值</li>
<li>数据为等级或顺序变量</li>
</ol>
<p>检验的假设为： H0：两组配对数据的差值的中位数为0 H1：两组配对数据的差值的中位数不为0</p>
<section id="进行-wilcoxon-符号秩检验" class="level3" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="进行-wilcoxon-符号秩检验"><span class="header-section-number">11.7.1</span> <strong>1. 进行 Wilcoxon 符号秩检验</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sleep"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 将数据按组拆分</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> sleep<span class="sc">$</span>extra[sleep<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>]  <span class="co"># 第一组数据</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> sleep<span class="sc">$</span>extra[sleep<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>]  <span class="co"># 第二组数据</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行 Wilcoxon 符号秩检验（配对检验）</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>wilcox_test_result <span class="ot">=</span> <span class="fu">wilcox.test</span>(group1, group2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  group1 and group2
V = 0, p-value = 0.009091
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>检验结果解释： 1. V统计量 = 0，表示所有负差值的秩和 2. p值 = 0.009 &lt; 0.05，说明两组数据存在显著差异 3. 由于是配对检验，结果反映了同一受试者在两种处理下的系统性差异</p>
</section>
<section id="数据可视化" class="level3" data-number="11.7.2">
<h3 data-number="11.7.2" class="anchored" data-anchor-id="数据可视化"><span class="header-section-number">11.7.2</span> <strong>2. 数据可视化</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制配对样本数据的箱线图 + 配对连线</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpaired</span>(sleep, <span class="at">x =</span> <span class="st">"group"</span>, <span class="at">y =</span> <span class="st">"extra"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"group"</span>, <span class="at">line.color =</span> <span class="st">"gray"</span>, <span class="at">line.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"wilcox.test"</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">label =</span> <span class="st">"p.format"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"两种药物对睡眠时间的影响（Wilcoxon 符号秩检验）"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"药物组"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"额外睡眠时间"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>可视化结果分析： 1. 箱线图显示了两组数据的分布特征： - 中位数 - 四分位数范围 - 可能的异常值 2. 灰色连线展示了配对样本的个体变化趋势 3. p值标注在图上，直观显示统计检验结果</p>
</section>
<section id="方法选择建议" class="level3" data-number="11.7.3">
<h3 data-number="11.7.3" class="anchored" data-anchor-id="方法选择建议"><span class="header-section-number">11.7.3</span> <strong>3. 方法选择建议</strong></h3>
<p>在实际应用中，我们需要根据数据特征选择合适的检验方法：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查数据的正态性</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>diff_values <span class="ot">=</span> group2 <span class="sc">-</span> group1  <span class="co"># 计算差值</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>shapiro_result <span class="ot">=</span> <span class="fu">shapiro.test</span>(diff_values)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出正态性检验结果</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"差值的正态性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>差值的正态性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"W ="</span>, <span class="fu">round</span>(shapiro_result<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W = 0.83 , p = 0.033 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法选择建议</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(shapiro_result<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">建议：数据差值近似正态分布，可以使用配对t检验</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">建议：数据差值偏离正态分布，应使用Wilcoxon符号秩检验</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
建议：数据差值偏离正态分布，应使用Wilcoxon符号秩检验</code></pre>
</div>
</div>
</section>
<section id="结果比较与解释" class="level3" data-number="11.7.4">
<h3 data-number="11.7.4" class="anchored" data-anchor-id="结果比较与解释"><span class="header-section-number">11.7.4</span> <strong>4. 结果比较与解释</strong></h3>
<p>配对t检验和Wilcoxon符号秩检验的结果比较：</p>
<ol type="1">
<li>统计效力：
<ul>
<li>当数据近似正态分布时，配对t检验的统计效力更高</li>
<li>当存在异常值或分布偏态时，Wilcoxon检验更稳健</li>
</ul></li>
<li>结果解释：
<ul>
<li>t检验比较均值差异</li>
<li>Wilcoxon检验比较中位数差异</li>
<li>两种方法得到相似的结论时，增加结果的可信度</li>
</ul></li>
<li>实践建议：
<ul>
<li>建议同时报告两种方法的结果</li>
<li>特别关注结果不一致的情况</li>
<li>结合具体研究背景选择更合适的方法</li>
</ul></li>
</ol>
<p>这种配对设计的分析方法在医学研究、心理学实验等领域有广泛应用，可以有效控制个体差异带来的影响。</p>
</section>
</section>
<section id="方差分析anova" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="方差分析anova"><span class="header-section-number">11.8</span> 方差分析(ANOVA)</h2>
<p>方差分析(Analysis of Variance, ANOVA)用于比较三个或更多组的均值是否存在显著差异。在进行ANOVA之前，需要满足以下假设：</p>
<ol type="1">
<li>独立性：各组样本相互独立</li>
<li>正态性：每组数据都近似服从正态分布</li>
<li>方差齐性：各组具有相同的总体方差</li>
</ol>
<p>我们使用ToothGrowth数据集中VC补充剂组的数据，分析不同剂量对牙齿生长的影响：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集并筛选 VC 处理的数据</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ToothGrowth"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>vc_data <span class="ot">=</span> <span class="fu">subset</span>(ToothGrowth, supp <span class="sc">==</span> <span class="st">"VC"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行单因素方差分析 (ANOVA)</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">=</span> <span class="fu">aov</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> vc_data)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出 ANOVA 结果</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
factor(dose)  2   1650   824.7   67.07 3.36e-11 ***
Residuals    27    332    12.3                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化：箱线图 + 组间显著性</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(vc_data, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"anova"</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"VC 处理下不同剂量对牙齿生长的影响（ANOVA）"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"剂量"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"牙齿长度"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>从ANOVA结果可以看出： 1. F值 = 67.42，表示组间变异与组内变异的比值 2. p值 &lt; 0.001，说明不同剂量组之间存在显著差异 3. 自由度：组间为2，组内为27 4. 可视化结果显示： - 随着剂量增加，牙齿生长长度呈现上升趋势 - 各组内部的变异程度相近 - 箱线图的重叠程度较小，支持显著性差异的结论</p>
<section id="假设检验" class="level3" data-number="11.8.1">
<h3 data-number="11.8.1" class="anchored" data-anchor-id="假设检验"><span class="header-section-number">11.8.1</span> 假设检验</h3>
<p>在进行方差分析之前，我们需要检验数据是否满足基本假设：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正态性检验</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>shapiro_05 <span class="ot">=</span> <span class="fu">shapiro.test</span>(vc_data<span class="sc">$</span>len[vc_data<span class="sc">$</span>dose <span class="sc">==</span> <span class="fl">0.5</span>])</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>shapiro_10 <span class="ot">=</span> <span class="fu">shapiro.test</span>(vc_data<span class="sc">$</span>len[vc_data<span class="sc">$</span>dose <span class="sc">==</span> <span class="fl">1.0</span>])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>shapiro_20 <span class="ot">=</span> <span class="fu">shapiro.test</span>(vc_data<span class="sc">$</span>len[vc_data<span class="sc">$</span>dose <span class="sc">==</span> <span class="fl">2.0</span>])</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差齐性检验</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>bartlett_result <span class="ot">=</span> <span class="fu">bartlett.test</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> vc_data)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"正态性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>正态性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"0.5mg组：W ="</span>, <span class="fu">round</span>(shapiro_05<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_05<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5mg组：W = 0.89 , p = 0.17 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1.0mg组：W ="</span>, <span class="fu">round</span>(shapiro_10<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_10<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0mg组：W = 0.908 , p = 0.27 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2.0mg组：W ="</span>, <span class="fu">round</span>(shapiro_20<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_20<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.0mg组：W = 0.973 , p = 0.919 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">方差齐性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
方差齐性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bartlett_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  len by factor(dose)
Bartlett's K-squared = 4.5119, df = 2, p-value = 0.1048</code></pre>
</div>
</div>
<p>检验结果分析： 1. 正态性检验： - 0.5mg组：p = 0.17 &gt; 0.05，满足正态性 - 1.0mg组：p = 0.27 &gt; 0.05，满足正态性 - 2.0mg组：p = 0.92 &gt; 0.05，满足正态性 2. Bartlett方差齐性检验： - p = 0.1048 &gt; 0.05，满足方差齐性假设</p>
<p>由于数据满足ANOVA的基本假设，我们可以相信方差分析的结果是可靠的。</p>
</section>
<section id="多重比较" class="level3" data-number="11.8.2">
<h3 data-number="11.8.2" class="anchored" data-anchor-id="多重比较"><span class="header-section-number">11.8.2</span> 多重比较</h3>
<p>当ANOVA结果显示组间存在显著差异时，我们需要进行事后多重比较，以确定具体哪些组之间存在差异：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行Tukey HSD多重比较</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">=</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出多重比较结果</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = len ~ factor(dose), data = vc_data)

$`factor(dose)`
       diff       lwr      upr    p adj
1-0.5  8.79  4.901765 12.67824 1.75e-05
2-0.5 18.16 14.271765 22.04824 0.00e+00
2-1    9.37  5.481765 13.25824 6.60e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化多重比较结果</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>多重比较结果解释： 1. 所有成对比较的p值都小于0.05，表明： - 1.0mg剂量组显著高于0.5mg组 - 2.0mg剂量组显著高于1.0mg组 - 2.0mg剂量组显著高于0.5mg组 2. 差异的大小： - 2.0mg vs 0.5mg：差异最大，约18.16 - 2.0mg vs 1.0mg：差异次之，约9.37 - 1.0mg vs 0.5mg：差异最小，约8.79 3. 置信区间都不包含0，进一步支持差异的显著性</p>
<p>这些结果表明维生素C对牙齿生长的促进作用具有明显的剂量依赖性，剂量越高，效果越显著。</p>
</section>
</section>
<section id="kruskal-wallis-检验" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="kruskal-wallis-检验"><span class="header-section-number">11.9</span> Kruskal-Wallis 检验</h2>
<p>Kruskal-Wallis检验是方差分析(ANOVA)的非参数替代方法，适用于以下情况：</p>
<ol type="1">
<li>数据不满足正态分布假设</li>
<li>组间方差不齐</li>
<li>样本量较小</li>
<li>数据为等级或顺序变量</li>
</ol>
<p>检验的假设为： H0：所有组的总体分布相同 H1：至少有一组的分布与其他组不同</p>
<p>我们继续使用ToothGrowth数据集中VC补充剂组的数据进行分析：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行 Kruskal-Wallis 检验</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>kruskal_result <span class="ot">=</span> <span class="fu">kruskal.test</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> vc_data)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kruskal_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  len by factor(dose)
Kruskal-Wallis chi-squared = 25.072, df = 2, p-value = 3.594e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化：箱线图 + 组间显著性</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(vc_data, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"kruskal.test"</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"VC 处理下不同剂量对牙齿生长的影响（Kruskal-Wallis）"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"剂量"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"牙齿长度"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>从Kruskal-Wallis检验结果可以看出：</p>
<ol type="1">
<li>检验统计量：
<ul>
<li>chi-squared = 25.072，表示组间差异的大小</li>
<li>自由度(df) = 2，对应三个剂量组</li>
<li>p值 &lt; 0.001，表明存在显著的组间差异</li>
</ul></li>
<li>可视化结果显示：
<ul>
<li>箱线图展示了各组的分布特征</li>
<li>随剂量增加，牙齿生长长度呈现上升趋势</li>
<li>p值标注在图上，直观显示显著性水平</li>
</ul></li>
</ol>
<section id="事后比较" class="level3" data-number="11.9.1">
<h3 data-number="11.9.1" class="anchored" data-anchor-id="事后比较"><span class="header-section-number">11.9.1</span> 事后比较</h3>
<p>当Kruskal-Wallis检验显示显著差异时，我们需要进行事后成对比较：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用Dunn检验进行多重比较</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunn.test)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dunn_result <span class="ot">=</span> <span class="fu">dunn.test</span>(vc_data<span class="sc">$</span>len, <span class="fu">factor</span>(vc_data<span class="sc">$</span>dose), </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Kruskal-Wallis rank sum test

data: x and group
Kruskal-Wallis chi-squared = 25.0722, df = 2, p-value = 0

                           Comparison of x by group                            
                                 (Bonferroni)                                  
Col Mean-|
Row Mean |        0.5          1
---------+----------------------
       1 |  -2.617076
         |    0.0133*
         |
       2 |  -5.005475  -2.388399
         |    0.0000*     0.0254

alpha = 0.05
Reject Ho if p &lt;= alpha/2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化成对比较结果</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(vc_data, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">"wilcox.test"</span>, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"0.5"</span>, <span class="st">"1"</span>), </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">"0.5"</span>, <span class="st">"2"</span>)),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"VC剂量组间的多重比较"</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"剂量(mg)"</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"牙齿长度"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>事后比较结果解释：</p>
<ol type="1">
<li>Dunn检验结果显示：
<ul>
<li>所有成对比较均显示显著差异(p &lt; 0.05)</li>
<li>Bonferroni校正用于控制多重比较的总体错误率(校正p值)</li>
</ul></li>
<li>可视化展示：
<ul>
<li>连接线和p值直观显示组间差异</li>
<li>可以清晰看到剂量增加带来的生长促进效应</li>
</ul></li>
</ol>
</section>
<section id="方法选择建议-1" class="level3" data-number="11.9.2">
<h3 data-number="11.9.2" class="anchored" data-anchor-id="方法选择建议-1"><span class="header-section-number">11.9.2</span> 方法选择建议</h3>
<p>在实际应用中，ANOVA和Kruskal-Wallis检验的选择取决于数据特征：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查各组的正态性和方差齐性</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>shapiro_results <span class="ot">=</span> <span class="fu">tapply</span>(vc_data<span class="sc">$</span>len, vc_data<span class="sc">$</span>dose, shapiro.test)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>bartlett_result <span class="ot">=</span> <span class="fu">bartlett.test</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> vc_data)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"正态性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>正态性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(dose <span class="cf">in</span> <span class="fu">unique</span>(vc_data<span class="sc">$</span>dose)) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">=</span> <span class="fu">shapiro.test</span>(vc_data<span class="sc">$</span>len[vc_data<span class="sc">$</span>dose <span class="sc">==</span> dose])</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(dose, <span class="st">"mg组: W ="</span>, <span class="fu">round</span>(test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">", p ="</span>, <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5 mg组: W = 0.89 , p = 0.17 
1 mg组: W = 0.908 , p = 0.27 
2 mg组: W = 0.973 , p = 0.919 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">方差齐性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
方差齐性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bartlett_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  len by factor(dose)
Bartlett's K-squared = 4.5119, df = 2, p-value = 0.1048</code></pre>
</div>
</div>
<p>方法选择建议：</p>
<ol type="1">
<li>当满足以下条件时，优先使用ANOVA：
<ul>
<li>各组数据近似正态分布</li>
<li>组间方差相等</li>
<li>样本量充足</li>
</ul></li>
<li>在以下情况下，应选择Kruskal-Wallis检验：
<ul>
<li>数据严重偏离正态分布</li>
<li>存在明显的异方差</li>
<li>样本量较小</li>
<li>数据为等级变量</li>
</ul></li>
<li>实践中的建议：
<ul>
<li>同时报告两种方法的结果可增加结论的可靠性</li>
<li>当两种方法得出不同结论时，需要谨慎解释</li>
<li>结合具体研究背景选择更合适的方法</li>
</ul></li>
</ol>
<p>这种非参数方法在生态学、医学等领域的数据分析中有广泛应用，特别是在处理非正态分布或异方差数据时。</p>
</section>
</section>
<section id="pearson相关系数" class="level2" data-number="11.10">
<h2 data-number="11.10" class="anchored" data-anchor-id="pearson相关系数"><span class="header-section-number">11.10</span> Pearson相关系数</h2>
<p>Pearson相关系数用于衡量两个连续变量之间的线性相关程度。在进行Pearson相关分析之前，需要满足以下假设：</p>
<ol type="1">
<li>变量为连续型数据</li>
<li>两个变量均服从正态分布</li>
<li>变量之间存在线性关系</li>
<li>没有显著的异常值</li>
</ol>
<p>我们使用mtcars数据集分析汽车马力(hp)和燃油效率(mpg)之间的关系：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mtcars"</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Pearson 相关系数</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>pearson_cor <span class="ot">=</span> <span class="fu">cor.test</span>(mtcars<span class="sc">$</span>mpg, mtcars<span class="sc">$</span>hp, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出相关性结果</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pearson_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  mtcars$mpg and mtcars$hp
t = -6.7424, df = 30, p-value = 1.788e-07
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.8852686 -0.5860994
sample estimates:
       cor 
-0.7761684 </code></pre>
</div>
</div>
<p>从Pearson相关分析结果可以看出：</p>
<ol type="1">
<li>相关系数 r = -0.776，表示强负相关关系</li>
<li>t统计量 = -6.7424，自由度 = 30</li>
<li>p值 &lt; 0.001，表明相关性极其显著</li>
<li>95%置信区间为[-0.885, -0.586]，不包含0，进一步支持显著相关性</li>
</ol>
<p>让我们通过可视化更直观地展示这种关系：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化：散点图 + Pearson 相关系数</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(mtcars, <span class="at">x =</span> <span class="st">"hp"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pearson 相关性分析：马力 (hp) vs. 燃油效率 (mpg)"</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"马力 (hp)"</span>,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"燃油效率 (mpg)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>可视化结果分析：</p>
<ol type="1">
<li>散点分布：
<ul>
<li>点的分布呈现明显的下降趋势</li>
<li>数据点较好地围绕回归线分布</li>
<li>没有明显的异常值或极端值</li>
</ul></li>
<li>回归线：
<ul>
<li>蓝色实线表示线性回归拟合</li>
<li>灰色区域表示95%置信区间</li>
<li>置信区间较窄，表明拟合较为可靠</li>
</ul></li>
<li>相关系数：
<ul>
<li>右上角显示相关系数和p值</li>
<li>负号表示随着马力增加，燃油效率下降</li>
<li>相关系数接近-1，表明关系较强</li>
</ul></li>
</ol>
<section id="检验假设条件" class="level3" data-number="11.10.1">
<h3 data-number="11.10.1" class="anchored" data-anchor-id="检验假设条件"><span class="header-section-number">11.10.1</span> 检验假设条件</h3>
<p>在解释结果之前，我们需要检验数据是否满足Pearson相关分析的假设：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正态性检验</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>shapiro_mpg <span class="ot">=</span> <span class="fu">shapiro.test</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>shapiro_hp <span class="ot">=</span> <span class="fu">shapiro.test</span>(mtcars<span class="sc">$</span>hp)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"正态性检验结果：</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>正态性检验结果：</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MPG: W ="</span>, <span class="fu">round</span>(shapiro_mpg<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_mpg<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MPG: W = 0.948 , p = 0.123 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"HP: W ="</span>, <span class="fu">round</span>(shapiro_hp<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_hp<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HP: W = 0.933 , p = 0.049 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 线性关系可视化</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"马力与燃油效率的关系"</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"使用LOESS曲线检查线性假设"</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"马力 (hp)"</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"燃油效率 (mpg)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>假设检验结果分析：</p>
<ol type="1">
<li>正态性检验：
<ul>
<li>MPG变量：p值显示是否满足正态分布</li>
<li>HP变量：p值显示是否满足正态分布</li>
</ul></li>
<li>线性关系检验：
<ul>
<li>LOESS曲线（局部多项式回归）用于检查非线性趋势</li>
<li>如果曲线接近直线，支持线性关系假设</li>
<li>置信区间的宽度反映了拟合的不确定性</li>
</ul></li>
</ol>
<p>这些检验结果将帮助我们判断Pearson相关分析结果的可靠性，并决定是否需要考虑使用其他方法（如Spearman相关系数）。</p>
</section>
</section>
<section id="spearman相关系数" class="level2" data-number="11.11">
<h2 data-number="11.11" class="anchored" data-anchor-id="spearman相关系数"><span class="header-section-number">11.11</span> Spearman相关系数</h2>
<p>Spearman相关系数是Pearson相关系数的非参数替代方法，适用于以下情况：</p>
<ol type="1">
<li>变量不满足正态分布假设</li>
<li>变量之间存在非线性单调关系</li>
<li>数据包含异常值</li>
<li>数据为等级或顺序变量</li>
</ol>
<p>检验的假设为： H0：两个变量之间不存在单调关系 H1：两个变量之间存在单调关系</p>
<p>我们继续使用mtcars数据集分析马力和燃油效率的关系：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Spearman 相关系数</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>spearman_cor <span class="ot">=</span> <span class="fu">cor.test</span>(mtcars<span class="sc">$</span>mpg, mtcars<span class="sc">$</span>hp, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出相关性结果</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(spearman_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  mtcars$mpg and mtcars$hp
S = 10337, p-value = 5.086e-12
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
-0.8946646 </code></pre>
</div>
</div>
<p>从Spearman相关分析结果可以看出：</p>
<ol type="1">
<li>相关系数 rho = -0.8946，表示很强的负相关关系</li>
<li>S统计量 = 10337，用于计算p值</li>
<li>p值 &lt; 0.001，表明相关性极其显著</li>
<li>相关系数比Pearson相关系数（-0.776）的绝对值更大，说明可能存在非线性关系</li>
</ol>
<p>让我们通过可视化来比较这种关系：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化：散点图 + Spearman 相关系数</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(mtcars, <span class="at">x =</span> <span class="st">"hp"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spearman 相关性分析：马力 (hp) vs. 燃油效率 (mpg)"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"马力 (hp)"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"燃油效率 (mpg)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>可视化结果分析：</p>
<ol type="1">
<li>散点分布：
<ul>
<li>点的分布呈现明显的下降趋势</li>
<li>在高马力区域，关系可能略有弯曲</li>
<li>个别点偏离主要趋势，但不影响Spearman相关性</li>
</ul></li>
<li>回归线：
<ul>
<li>红色实线表示线性趋势</li>
<li>灰色区域表示95%置信区间</li>
<li>某些区域的点与线的偏离较大，暗示可能存在非线性关系</li>
</ul></li>
<li>相关系数：
<ul>
<li>右上角显示Spearman相关系数和p值</li>
<li>负号表示随着马力增加，燃油效率下降</li>
<li>相关系数接近-1，表明单调递减关系很强</li>
</ul></li>
</ol>
<section id="与pearson相关系数的比较" class="level3" data-number="11.11.1">
<h3 data-number="11.11.1" class="anchored" data-anchor-id="与pearson相关系数的比较"><span class="header-section-number">11.11.1</span> 与Pearson相关系数的比较</h3>
<p>让我们对比两种相关分析方法的结果：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建比较数据框</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>correlations <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>),</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Coefficient =</span> <span class="fu">c</span>(pearson_cor<span class="sc">$</span>estimate, spearman_cor<span class="sc">$</span>estimate),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_value =</span> <span class="fu">c</span>(pearson_cor<span class="sc">$</span>p.value, spearman_cor<span class="sc">$</span>p.value)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示比较结果</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Method Coefficient      P_value
cor  Pearson  -0.7761684 1.787835e-07
rho Spearman  -0.8946646 5.085969e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化两种方法的比较</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtcars<span class="sc">$</span>hp, mtcars<span class="sc">$</span>mpg, <span class="at">main =</span> <span class="st">"Pearson相关"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"马力"</span>, <span class="at">ylab =</span> <span class="st">"燃油效率"</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rank</span>(mtcars<span class="sc">$</span>hp), <span class="fu">rank</span>(mtcars<span class="sc">$</span>mpg), <span class="at">main =</span> <span class="st">"Spearman相关（秩）"</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"马力（秩）"</span>, <span class="at">ylab =</span> <span class="st">"燃油效率（秩）"</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">rank</span>(mpg) <span class="sc">~</span> <span class="fu">rank</span>(hp), <span class="at">data =</span> mtcars), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>方法比较分析：</p>
<ol type="1">
<li>相关系数大小：
<ul>
<li>Spearman相关系数的绝对值更大</li>
<li>说明数据可能存在非线性单调关系</li>
<li>Spearman方法可能更适合描述这种关系</li>
</ul></li>
<li>统计显著性：
<ul>
<li>两种方法都显示极其显著的相关性</li>
<li>p值都远小于0.05的显著性水平</li>
<li>结论的可靠性得到双重支持</li>
</ul></li>
<li>实践建议：
<ul>
<li>当数据不满足正态性时，优先使用Spearman相关</li>
<li>当关注变量间的单调关系时，Spearman更合适</li>
<li>同时报告两种方法的结果可增加结论的可靠性</li>
</ul></li>
</ol>
<p>这个案例说明，在实际数据分析中，选择合适的相关分析方法对于准确理解变量关系至关重要。</p>
</section>
</section>
<section id="多变量分析" class="level2" data-number="11.12">
<h2 data-number="11.12" class="anchored" data-anchor-id="多变量分析"><span class="header-section-number">11.12</span> 多变量分析</h2>
<p>以下是使用R语言内置数据集进行 MANOVA、RDA、CCA和PERMANOVA分析的示例代码及详细解释：</p>
<section id="manova多变量方差分析" class="level3" data-number="11.12.1">
<h3 data-number="11.12.1" class="anchored" data-anchor-id="manova多变量方差分析"><span class="header-section-number">11.12.1</span> MANOVA（多变量方差分析）</h3>
<p><strong>数据集</strong>：<code>iris</code>（R内置数据集）<br>
<strong>生物学意义</strong>：比较不同鸢尾花物种（setosa、versicolor、virginica）在萼片和花瓣形态特征上的差异。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行MANOVA：检验物种对多个形态特征的影响</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>manova_fit <span class="ot">&lt;-</span> <span class="fu">manova</span>(</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) <span class="sc">~</span> Species, </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> iris</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看整体显著性（使用Pillai检验）</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manova_fit, <span class="at">test =</span> <span class="st">"Pillai"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Df Pillai approx F num Df den Df    Pr(&gt;F)    
Species     2 1.1919   53.466      8    290 &lt; 2.2e-16 ***
Residuals 147                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出Pillai's trace统计量和p值，p &lt; 0.05表示物种间存在显著差异</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看单变量ANOVA结果（每个特征的独立检验）</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(manova_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response Sepal.Length :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals   147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Sepal.Width :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
Residuals   147 16.962  0.1154                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Petal.Length :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 437.10 218.551  1180.2 &lt; 2.2e-16 ***
Residuals   147  27.22   0.185                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Petal.Width :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 80.413  40.207  960.01 &lt; 2.2e-16 ***
Residuals   147  6.157   0.042                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出每个形态特征的F值和p值，例如Petal.Length的差异最显著</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rda冗余分析" class="level3" data-number="11.12.2">
<h3 data-number="11.12.2" class="anchored" data-anchor-id="rda冗余分析"><span class="header-section-number">11.12.2</span> RDA（冗余分析）</h3>
<p><strong>数据集</strong>：<code>varespec</code>和<code>varechem</code>（<code>vegan</code>包）<br>
<strong>生物学意义</strong>：分析土壤化学性质（如pH、氮含量）如何影响植被群落组成。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varespec)  <span class="co"># 植被物种多度数据</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)   <span class="co"># 土壤化学数据</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据预处理：对物种数据进行Hellinger转换（降低双零敏感性）</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>spe_hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(varespec, <span class="at">method =</span> <span class="st">"hellinger"</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行RDA：环境变量解释物种组成</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>rda_result <span class="ot">&lt;-</span> <span class="fu">rda</span>(spe_hel <span class="sc">~</span> ., <span class="at">data =</span> varechem)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看模型摘要（约束轴解释的方差比例）</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rda_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(formula = spe_hel ~ N + P + K + Ca + Mg + S + Al + Fe + Mn +      Zn + Mo + Baresoil + Humdepth + pH, data = varechem) 

Partitioning of variance:
              Inertia Proportion
Total          0.3647     1.0000
Constrained    0.2551     0.6995
Unconstrained  0.1096     0.3005

Eigenvalues, and their contribution to the variance 

Importance of components:
                        RDA1    RDA2    RDA3    RDA4    RDA5     RDA6     RDA7
Eigenvalue            0.1115 0.06171 0.02137 0.01843 0.01370 0.007873 0.006766
Proportion Explained  0.3056 0.16922 0.05859 0.05053 0.03758 0.021589 0.018554
Cumulative Proportion 0.3056 0.47484 0.53342 0.58395 0.62153 0.643116 0.661670
                          RDA8     RDA9    RDA10    RDA11    RDA12    RDA13
Eigenvalue            0.004602 0.002458 0.002058 0.001542 0.001277 0.001237
Proportion Explained  0.012621 0.006740 0.005643 0.004230 0.003502 0.003391
Cumulative Proportion 0.674291 0.681031 0.686674 0.690904 0.694406 0.697797
                          RDA14    PC1     PC2     PC3     PC4      PC5     PC6
Eigenvalue            0.0006376 0.0483 0.02129 0.01089 0.01025 0.007383 0.00559
Proportion Explained  0.0017483 0.1324 0.05837 0.02985 0.02810 0.020246 0.01533
Cumulative Proportion 0.6995457 0.8320 0.89036 0.92022 0.94832 0.968562 0.98389
                           PC7      PC8       PC9
Eigenvalue            0.003041 0.001937 0.0008977
Proportion Explained  0.008338 0.005310 0.0024616
Cumulative Proportion 0.992228 0.997538 1.0000000

Accumulated constrained eigenvalues
Importance of components:
                        RDA1    RDA2    RDA3    RDA4    RDA5     RDA6     RDA7
Eigenvalue            0.1115 0.06171 0.02137 0.01843 0.01370 0.007873 0.006766
Proportion Explained  0.4369 0.24189 0.08375 0.07223 0.05372 0.030862 0.026523
Cumulative Proportion 0.4369 0.67878 0.76253 0.83476 0.88847 0.919334 0.945857
                          RDA8     RDA9    RDA10    RDA11    RDA12    RDA13
Eigenvalue            0.004602 0.002458 0.002058 0.001542 0.001277 0.001237
Proportion Explained  0.018041 0.009635 0.008067 0.006046 0.005006 0.004848
Cumulative Proportion 0.963898 0.973533 0.981600 0.987646 0.992653 0.997501
                          RDA14
Eigenvalue            0.0006376
Proportion Explained  0.0024993
Cumulative Proportion 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 例如，前两个RDA轴共解释30%的方差</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 检验模型显著性</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rda_result, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = spe_hel ~ N + P + K + Ca + Mg + S + Al + Fe + Mn + Zn + Mo + Baresoil + Humdepth + pH, data = varechem)
         Df Variance      F Pr(&gt;F)  
Model    14  0.25511 1.4968  0.058 .
Residual  9  0.10957                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt; 0.05表示环境变量对物种组成有显著影响</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rda_result, <span class="at">display =</span> <span class="fu">c</span>(<span class="st">"sites"</span>, <span class="st">"bp"</span>), <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 箭头表示环境变量方向，点表示样方</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cca典型对应分析" class="level3" data-number="11.12.3">
<h3 data-number="11.12.3" class="anchored" data-anchor-id="cca典型对应分析"><span class="header-section-number">11.12.3</span> CCA（典型对应分析）</h3>
<p><strong>数据集</strong>：<code>dune</code>和<code>dune.env</code>（<code>vegan</code>包）<br>
<strong>生物学意义</strong>：探究土壤厚度（A1）和湿度（Moisture）对沙丘植物群落分布的影响。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune)      <span class="co"># 植物物种多度数据</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune.env)  <span class="co"># 环境变量数据</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行CCA：分析环境变量与物种的关系</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>cca_result <span class="ot">&lt;-</span> <span class="fu">cca</span>(dune <span class="sc">~</span> A1 <span class="sc">+</span> Moisture, <span class="at">data =</span> dune.env)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看模型摘要（轴解释的方差比例）</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cca_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
cca(formula = dune ~ A1 + Moisture, data = dune.env) 

Partitioning of scaled Chi-square:
              Inertia Proportion
Total          2.1153     1.0000
Constrained    0.7437     0.3516
Unconstrained  1.3715     0.6484

Eigenvalues, and their contribution to the scaled Chi-square 

Importance of components:
                        CCA1    CCA2    CCA3    CCA4    CA1    CA2     CA3
Eigenvalue            0.4314 0.13503 0.10663 0.07063 0.3843 0.2140 0.16009
Proportion Explained  0.2040 0.06384 0.05041 0.03339 0.1817 0.1012 0.07568
Cumulative Proportion 0.2040 0.26780 0.31821 0.35160 0.5333 0.6344 0.71012
                          CA4     CA5     CA6     CA7     CA8     CA9    CA10
Eigenvalue            0.12256 0.09894 0.09023 0.07506 0.06051 0.05388 0.04558
Proportion Explained  0.05794 0.04677 0.04266 0.03549 0.02860 0.02547 0.02155
Cumulative Proportion 0.76806 0.81483 0.85749 0.89298 0.92158 0.94706 0.96860
                          CA11     CA12    CA13     CA14     CA15
Eigenvalue            0.020885 0.015352 0.01252 0.009600 0.008053
Proportion Explained  0.009874 0.007258 0.00592 0.004538 0.003807
Cumulative Proportion 0.978477 0.985735 0.99165 0.996193 1.000000

Accumulated constrained eigenvalues
Importance of components:
                        CCA1   CCA2   CCA3    CCA4
Eigenvalue            0.4314 0.1350 0.1066 0.07063
Proportion Explained  0.5801 0.1816 0.1434 0.09497
Cumulative Proportion 0.5801 0.7617 0.9050 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 例如，CCA1解释15%的物种-环境关系</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 检验模型显著性</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(cca_result, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for cca under reduced model
Permutation: free
Number of permutations: 999

Model: cca(formula = dune ~ A1 + Moisture, data = dune.env)
         Df ChiSquare      F Pr(&gt;F)   
Model     4   0.74374 2.0335  0.005 **
Residual 15   1.37153                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt; 0.05表示环境变量对物种分布有显著影响</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cca_result, <span class="at">display =</span> <span class="fu">c</span>(<span class="st">"sites"</span>, <span class="st">"cn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 箭头表示环境变量，点表示样方，物种标签默认隐藏</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="permanova非参数多变量方差分析" class="level3" data-number="11.12.4">
<h3 data-number="11.12.4" class="anchored" data-anchor-id="permanova非参数多变量方差分析"><span class="header-section-number">11.12.4</span> PERMANOVA（非参数多变量方差分析）</h3>
<p><strong>数据集</strong>：<code>dune</code>和<code>dune.env</code>（<code>vegan</code>包）<br>
<strong>生物学意义</strong>：检验不同管理方式（Management）对沙丘植物群落组成的影响。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune.env)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Bray-Curtis距离矩阵</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>dist_dune <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(dune, <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行PERMANOVA（基于999次置换检验）</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>permanova_result <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  dist_dune <span class="sc">~</span> Management, </span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dune.env, </span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(permanova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = dist_dune ~ Management, data = dune.env, permutations = 999)
         Df SumOfSqs      R2      F Pr(&gt;F)    
Model     3   1.4686 0.34161 2.7672  0.001 ***
Residual 16   2.8304 0.65839                  
Total    19   4.2990 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R²表示管理方式解释的方差比例，p &lt; 0.05表示组间差异显著</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="关键区别与生物学解释" class="level3" data-number="11.12.5">
<h3 data-number="11.12.5" class="anchored" data-anchor-id="关键区别与生物学解释"><span class="header-section-number">11.12.5</span> 关键区别与生物学解释</h3>
<ul>
<li><strong>MANOVA</strong>：检验分类变量（如物种）对多个连续变量的联合影响（如形态特征差异）。<br>
</li>
<li><strong>RDA</strong>：约束排序，假设物种-环境关系为线性（如土壤养分梯度）。<br>
</li>
<li><strong>CCA</strong>：对应排序，假设物种-环境关系为单峰（如湿度梯度下的物种最适分布）。<br>
</li>
<li><strong>PERMANOVA</strong>：非参数检验组间群落差异（如管理方式对多样性的影响）。</li>
</ul>
<p>通过上述分析，可深入理解生态数据中复杂的多变量关系。</p>
</section>
</section>
<section id="mantel-分析" class="level2" data-number="11.13">
<h2 data-number="11.13" class="anchored" data-anchor-id="mantel-分析"><span class="header-section-number">11.13</span> Mantel 分析</h2>
<p>Mantel 分析用于比较 <strong>两个距离矩阵之间的相关性</strong>，在生态学研究中常用于分析 <strong>群落结构与环境因子之间的关系</strong>。这里我们使用 <strong>vegan</strong> 包中的 <strong>dune</strong>（植物群落数据）和 <strong>dune.env</strong>（环境数据）进行 Mantel 分析，并进行可视化。</p>
<section id="加载必要的-r-包和数据" class="level3" data-number="11.13.1">
<h3 data-number="11.13.1" class="anchored" data-anchor-id="加载必要的-r-包和数据"><span class="header-section-number">11.13.1</span> 加载必要的 R 包和数据</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的 R 包</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)   <span class="co"># 生态数据分析</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># 数据可视化</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)  <span class="co"># 增强 ggplot2</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)     <span class="co"># 计算距离矩阵</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载 dune 物种丰度数据和 dune.env 环境数据</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"dune"</span>)       <span class="co"># 物种群落数据</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"dune.env"</span>)   <span class="co"># 环境因子数据</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="计算距离矩阵" class="level3" data-number="11.13.2">
<h3 data-number="11.13.2" class="anchored" data-anchor-id="计算距离矩阵"><span class="header-section-number">11.13.2</span> 计算距离矩阵</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算物种群落的 Bray-Curtis 距离矩阵</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dune_dist <span class="ot">=</span> <span class="fu">vegdist</span>(dune, <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算环境变量的欧几里得距离矩阵</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>env_dist <span class="ot">=</span> <span class="fu">dist</span>(dune.env[, <span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"Moisture"</span>, <span class="st">"Management"</span>)])  <span class="co"># 选择部分环境变量</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="解释-1" class="level4" data-number="11.13.2.1">
<h4 data-number="11.13.2.1" class="anchored" data-anchor-id="解释-1"><span class="header-section-number">11.13.2.1</span> 解释</h4>
<ul>
<li><code>vegdist(dune, method = "bray")</code> 计算 <strong>群落物种丰度的 Bray-Curtis 距离矩阵</strong>：
<ul>
<li>适用于生态群落数据</li>
<li>考虑物种的相对丰度</li>
<li>值域为0-1，0表示完全相同，1表示完全不同</li>
</ul></li>
<li><code>dist(dune.env[, c("A1", "Moisture", "Management")])</code> 计算 <strong>环境因子的欧几里得距离矩阵</strong>：
<ul>
<li>选取关键环境变量</li>
<li>标准化处理以消除量纲影响</li>
<li>反映样点间环境条件的差异程度</li>
</ul></li>
</ul>
</section>
</section>
<section id="进行-mantel-分析" class="level3" data-number="11.13.3">
<h3 data-number="11.13.3" class="anchored" data-anchor-id="进行-mantel-分析"><span class="header-section-number">11.13.3</span> 进行 Mantel 分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行 Mantel 检验</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>mantel_result <span class="ot">=</span> <span class="fu">mantel</span>(dune_dist, env_dist, <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出 Mantel 统计结果</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mantel_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mantel statistic based on Spearman's rank correlation rho 

Call:
mantel(xdis = dune_dist, ydis = env_dist, method = "spearman",      permutations = 999) 

Mantel statistic r: 0.4634 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.147 0.191 0.225 0.260 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</div>
<section id="解释-2" class="level4" data-number="11.13.3.1">
<h4 data-number="11.13.3.1" class="anchored" data-anchor-id="解释-2"><span class="header-section-number">11.13.3.1</span> 解释</h4>
<ul>
<li><code>mantel(dune_dist, env_dist, method = "spearman", permutations = 999)</code>：
<ul>
<li><code>method = "spearman"</code>：使用 <strong>Spearman 相关性</strong>（适用于非线性关系）</li>
<li><code>permutations = 999</code>：进行 <strong>999 次置换检验</strong>，评估显著性</li>
</ul></li>
<li>Mantel 结果的关键指标：
<ul>
<li><code>Mantel statistic r</code>：表示两个矩阵之间的相关性（0 = 无关，接近 1 表示强相关）</li>
<li><code>Significance (p-value)</code>：若 <strong>p &lt; 0.05</strong>，说明群落结构与环境因子显著相关</li>
</ul></li>
</ul>
</section>
</section>
<section id="可视化-mantel-相关性" class="level3" data-number="11.13.4">
<h3 data-number="11.13.4" class="anchored" data-anchor-id="可视化-mantel-相关性"><span class="header-section-number">11.13.4</span> 可视化 Mantel 相关性</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取距离矩阵中的非对角元素</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>dune_values <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">as.dist</span>(dune_dist))</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>env_values <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">as.dist</span>(env_dist))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>mantel_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Dune_Distance =</span> dune_values, <span class="at">Env_Distance =</span> env_values)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制散点图并添加拟合线</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mantel_data, <span class="fu">aes</span>(<span class="at">x =</span> Env_Distance, <span class="at">y =</span> Dune_Distance)) <span class="sc">+</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># 绘制散点</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  <span class="co"># 添加线性拟合线</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mantel 相关性分析"</span>,</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Mantel 统计量 r ="</span>, <span class="fu">round</span>(mantel_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">", p ="</span>, mantel_result<span class="sc">$</span>signif),</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"环境因子距离"</span>,</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"物种群落距离"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="grouped-data-analysis_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="解释-3" class="level4" data-number="11.13.4.1">
<h4 data-number="11.13.4.1" class="anchored" data-anchor-id="解释-3"><span class="header-section-number">11.13.4.1</span> 解释</h4>
<ol type="1">
<li><code>as.vector(as.dist(dune_dist))</code> 和 <code>as.vector(as.dist(env_dist))</code>：提取距离矩阵的 <strong>非对角元素</strong>，转换为向量</li>
<li><code>ggplot()</code> 可视化：
<ul>
<li><strong>散点图</strong> (<code>geom_point()</code>)：展示群落距离 vs.&nbsp;环境距离的关系</li>
<li><strong>线性拟合曲线</strong> (<code>geom_smooth(method = "lm")</code>)：观察趋势，<code>se = TRUE</code> 表示 95% 置信区间</li>
<li><strong>标题显示 Mantel 统计量和 p 值</strong>，直观了解相关性大小和显著性</li>
</ul></li>
</ol>
</section>
</section>
<section id="mantel-分析的生物学意义" class="level3" data-number="11.13.5">
<h3 data-number="11.13.5" class="anchored" data-anchor-id="mantel-分析的生物学意义"><span class="header-section-number">11.13.5</span> Mantel 分析的生物学意义</h3>
<section id="生态学背景" class="level4" data-number="11.13.5.1">
<h4 data-number="11.13.5.1" class="anchored" data-anchor-id="生态学背景"><span class="header-section-number">11.13.5.1</span> 生态学背景</h4>
<ul>
<li><strong>生态群落结构</strong> 受 <strong>环境因子</strong>（如土壤湿度、养分、管理方式）影响</li>
<li>Mantel 检验评估 <strong>环境梯度如何驱动群落变化</strong>，可用于 <strong>生物地理学、生态恢复、物种共存机制</strong> 研究</li>
</ul>
</section>
<section id="mantel-结果解读" class="level4" data-number="11.13.5.2">
<h4 data-number="11.13.5.2" class="anchored" data-anchor-id="mantel-结果解读"><span class="header-section-number">11.13.5.2</span> Mantel 结果解读</h4>
<ul>
<li><strong>r &gt; 0 &amp; p &lt; 0.05</strong>：群落组成 <strong>显著受环境因子影响</strong>，环境因子可能驱动物种分布</li>
<li><strong>r 近 0 &amp; p &gt; 0.05</strong>：环境因子与群落 <strong>无显著相关性</strong>，说明可能受 <strong>竞争、演替、历史过程等</strong> 影响</li>
<li><strong>r &lt; 0</strong>：环境因子可能具有 <strong>负向影响</strong>（如环境胁迫）</li>
</ul>
</section>
</section>
<section id="总结-1" class="level3" data-number="11.13.6">
<h3 data-number="11.13.6" class="anchored" data-anchor-id="总结-1"><span class="header-section-number">11.13.6</span> 总结</h3>
<ol type="1">
<li><strong>计算群落丰度和环境因子的距离矩阵</strong>（Bray-Curtis vs.&nbsp;欧几里得）</li>
<li><strong>Mantel 检验</strong> 评估二者的相关性，并进行显著性检验</li>
<li><strong>可视化</strong> 相关性，直观观察环境梯度对群落结构的影响</li>
<li><strong>生物学意义</strong>：揭示环境因子如何驱动群落结构变化，指导生态管理与生物多样性保护</li>
</ol>
</section>
</section>
<section id="详解-mantel-检验" class="level2" data-number="11.14">
<h2 data-number="11.14" class="anchored" data-anchor-id="详解-mantel-检验"><span class="header-section-number">11.14</span> 详解 Mantel 检验</h2>
<p>Mantel 统计量是一种用于分析两个距离矩阵之间相关性的统计方法，主要应用于生态学、遗传学等领域，来研究空间或环境变量与生物群落数据之间的关系。其核心原理如下：</p>
<section id="距离矩阵的构建" class="level3" data-number="11.14.1">
<h3 data-number="11.14.1" class="anchored" data-anchor-id="距离矩阵的构建"><span class="header-section-number">11.14.1</span> 距离矩阵的构建</h3>
<ul>
<li>Mantel 检验的输入是两个对称距离矩阵（或相似性矩阵），它们分别表示：
<ul>
<li>矩阵 <span class="math inline">\(A\)</span>：变量之间的距离（如地理距离、环境差异）</li>
<li>矩阵 <span class="math inline">\(B\)</span>：响应变量之间的距离（如群落组成差异、遗传差异）</li>
</ul></li>
</ul>
<p>每个矩阵的元素 <span class="math inline">\(a_{ij}\)</span> 和 <span class="math inline">\(b_{ij}\)</span> 表示样本 <span class="math inline">\(i\)</span> 和 <span class="math inline">\(j\)</span> 之间的距离。</p>
</section>
<section id="计算观察相关性" class="level3" data-number="11.14.2">
<h3 data-number="11.14.2" class="anchored" data-anchor-id="计算观察相关性"><span class="header-section-number">11.14.2</span> 计算观察相关性</h3>
<ul>
<li>Mantel 统计量通过以两个距离矩阵的<strong>Pearson相关系数</strong>表示，计算公式为：</li>
</ul>
<p><span class="math display">\[
r = \frac{\sum_{i=1}^n \sum_{j=1}^n (a_{ij} - \bar{A})(b_{ij} - \bar{B})}{\sqrt{\sum_{i=1}^n \sum_{j=1}^n (a_{ij} - \bar{A})^2} \cdot \sqrt{\sum_{i=1}^n \sum_{j=1}^n (b_{ij} - \bar{B})^2}}
\]</span></p>
<p>其中： - <span class="math inline">\(a_{ij}\)</span> 和 <span class="math inline">\(b_{ij}\)</span> 是两个矩阵中对应位的距离值 - <span class="math inline">\(\bar{A}\)</span> 和 <span class="math inline">\(\bar{B}\)</span> 是矩阵的均值 - <span class="math inline">\(n\)</span> 是样本数量</p>
</section>
<section id="置换检验" class="level3" data-number="11.14.3">
<h3 data-number="11.14.3" class="anchored" data-anchor-id="置换检验"><span class="header-section-number">11.14.3</span> 置换检验</h3>
<p>为了评估相关性的显著性，Mantel 检验通过以下步骤进行置换检验：</p>
<ol type="1">
<li>计算原始矩阵间的相关系数 <span class="math inline">\(r_{obs}\)</span></li>
<li>随机打乱其中一个矩阵（通常是矩阵 <span class="math inline">\(B\)</span>）的行和列</li>
<li>计算随机化后的相关系数 <span class="math inline">\(r_{rand}\)</span></li>
<li>重复步骤2-3多次（通常999或9999次）</li>
<li>计算p值：<span class="math inline">\(p = \frac{N(r_{rand} \geq r_{obs})}{N_{perm}}\)</span></li>
</ol>
<p>其中： - <span class="math inline">\(N(r_{rand} \geq r_{obs})\)</span> 是随机值大于等于观察值的次数 - <span class="math inline">\(N_{perm}\)</span> 是总置换次数</p>
</section>
<section id="应用场景" class="level3" data-number="11.14.4">
<h3 data-number="11.14.4" class="anchored" data-anchor-id="应用场景"><span class="header-section-number">11.14.4</span> 应用场景</h3>
<p>Mantel检验在多个领域有重要应用：</p>
<ol type="1">
<li><strong>生态学</strong>：
<ul>
<li>物种组成与环境因子的关系</li>
<li>群落结构的空间自相关</li>
<li>生态系统功能的相似性分析</li>
</ul></li>
<li><strong>遗传学</strong>：
<ul>
<li>遗传距离与地理距离的关系</li>
<li>基因流动与环境阻隔的关联</li>
<li>种群遗传结构的空间格局</li>
</ul></li>
<li><strong>微生物生态学</strong>：
<ul>
<li>微生物群落与环境参数的关联</li>
<li>宿主-微生物互作关系</li>
<li>微生物空间分布模式</li>
</ul></li>
</ol>
</section>
<section id="优缺点分析" class="level3" data-number="11.14.5">
<h3 data-number="11.14.5" class="anchored" data-anchor-id="优缺点分析"><span class="header-section-number">11.14.5</span> 优缺点分析</h3>
<section id="优点" class="level4" data-number="11.14.5.1">
<h4 data-number="11.14.5.1" class="anchored" data-anchor-id="优点"><span class="header-section-number">11.14.5.1</span> 优点：</h4>
<ol type="1">
<li><strong>灵活性</strong>：
<ul>
<li>可处理不同类型的距离度量</li>
<li>适用于非线性关系</li>
<li>可分析多维数据</li>
</ul></li>
<li><strong>稳健性</strong>：
<ul>
<li>对异常值不敏感</li>
<li>不要求数据正态分布</li>
<li>置换检验提供可靠的显著性评估</li>
</ul></li>
<li><strong>解释性</strong>：
<ul>
<li>结果易于理解和解释</li>
<li>可视化直观明了</li>
<li>与生态学理论良好结合</li>
</ul></li>
</ol>
</section>
<section id="局限性" class="level4" data-number="11.14.5.2">
<h4 data-number="11.14.5.2" class="anchored" data-anchor-id="局限性"><span class="header-section-number">11.14.5.2</span> 局限性：</h4>
<ol type="1">
<li><strong>统计效力</strong>：
<ul>
<li>对弱相关性的检测力较低</li>
<li>需要较大样本量</li>
<li>计算密集型，耗时较长</li>
</ul></li>
<li><strong>假设限制</strong>：
<ul>
<li>假设观测值独立</li>
<li>不能处理条件化效应</li>
<li>难以处理时间序列数据</li>
</ul></li>
<li><strong>解释局限</strong>：
<ul>
<li>仅反映整体相关性</li>
<li>无法识别局部模式</li>
<li>不能确定因果关系</li>
</ul></li>
</ol>
</section>
</section>
<section id="实践建议" class="level3" data-number="11.14.6">
<h3 data-number="11.14.6" class="anchored" data-anchor-id="实践建议"><span class="header-section-number">11.14.6</span> 实践建议</h3>
<ol type="1">
<li><strong>数据预处理</strong>：
<ul>
<li>选择合适的距离度量</li>
<li>标准化原始数据</li>
<li>处理缺失值</li>
</ul></li>
<li><strong>检验设计</strong>：
<ul>
<li>确定适当的置换次数</li>
<li>考虑多重比较校正</li>
<li>结合其他统计方法</li>
</ul></li>
<li><strong>结果解释</strong>：
<ul>
<li>结合生物学背景</li>
<li>考虑空间自相关</li>
<li>谨慎推断因果关系</li>
</ul></li>
</ol>
<p>通过深入理解Mantel检验的原理和应用，我们可以更好地利用这一方法来研究复杂的生态学和进化生物学问题。</p>


</section>
</section>

</main> <!-- /main -->
<script src="https://giscus.app/client.js" data-repo="D2RS-2025spring/data-driven-reproducible-study" data-repo-id="R_kgDONqlH8A" data-category="General" data-category-id="DIC_kwDONqlH8M4CnKvW" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async="">
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./git-basic.html" class="pagination-link" aria-label="Git 与 GitHub 入门">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Git 与 GitHub 入门</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./grouped-data-analysis-in-action.html" class="pagination-link" aria-label="分组数据分析实战">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">分组数据分析实战</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/edit/main/grouped-data-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/blob/main/grouped-data-analysis.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/D2RS-2025spring/data-driven-reproducible-study/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script async="" src="https://hypothes.is/embed.js"></script>




</body></html>